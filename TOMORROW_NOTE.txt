Tomorrow Priority Note
Updated: 2026-02-15

1) Immediate verification after deploy
- Run Site Audit Pro on production.
- Download XLSX and verify that export no longer fails on null issue details.
- Check status/risk/toxicity coloring across all tabs.

2) What was completed today
- Fixed XLSX export crash: NoneType subscriptable in Issues Raw hash generation.
- Implemented Stage 4 visual polish:
  - unified KPI conditional formatting,
  - unified status palette (good/warn/bad),
  - hierarchy status explicit mapping,
  - per-column anomaly highlighting for KPI numeric values.
- Added and updated GitHub project meta files:
  README, CODE_OF_CONDUCT, CONTRIBUTING, LICENSE, SECURITY,
  issue templates and PR template.

3) Methods used (for continuation)
- Centralized logic in `app/reports/xlsx_generator.py`:
  - `_kpi_status_from_value`, `_status_palette`, `_apply_kpi_cell_style`,
  - `_kpi_anomaly_direction`, `_quantile`, anomaly pass inside `fill_sheet`.
- Kept compatibility by applying formatting in `fill_sheet`, not per-sheet duplication.
- Guarded robustness for mixed/null data before writing XLSX.
- Validated each stage with:
  - targeted unit tests,
  - `scripts/site_pro_preflight.py`,
  - encoding guard checks.

4) Recommended first task tomorrow
- Fine-tune thresholds for specific columns based on real production datasets
  (toxicity, hierarchy status, risk score, indexability level).
